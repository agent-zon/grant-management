_schema-version: "1.0"
repository: scai-dev.common.repositories.cloud.sap
tag: latest
before-all:
  - npx cds build --production

modules:
  - name: grant-management/api
    build-parameters:
      commands:
        - docker buildx build --platform linux/amd64 -t grant-management/api:latest -f Dockerfile . --load

  - name: grant-management/approuter
    id: grant-management-approuter
    build-parameters:
      commands:
        - docker buildx build --platform linux/amd64 -t grant-management/approuter:latest app/router --load
  - name: v1-approuter
    build-parameters:
      buildpack:
        type: nodejs
        builder: builder-jammy-base
        path: app/router
        env:
          BP_NODE_RUN_SCRIPTS: ""
  # - name: v1-approuter
  #   build-parameters:
  #     buildpack:
  #       type: nodejs
  #       builder: builder-jammy-base
  #       path: app/router
  #       env:
  #         BP_NODE_RUN_SCRIPTS: ""
  # - name: grant-management/portal
  #   build-parameters:
  #     commands:
  #       - docker buildx build --platform linux/amd64 -t grant-management/portal:latest  app/portal --load
